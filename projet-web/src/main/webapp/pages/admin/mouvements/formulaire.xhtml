<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<ui:composition template="/template/page-standard.xhtml">
    <ui:define name="titre">
        #{modelMouvement.courant.id == null ? 'Nouveau mouvement' : 'Modifier le mouvement'}
    </ui:define>
    <ui:define name="contenu">
        <h2>#{modelMouvement.courant.id == null ? '‚ûï Cr√©er un nouveau mouvement financier' : '‚úèÔ∏è Modifier le mouvement financier'}</h2>

        <div class="form-help">
            <p>
                üí° Un mouvement financier repr√©sente une transaction li√©e √† un compte bancaire.
                Renseignez la date, le libell√© descriptif, le montant et le compte associ√©.
            </p>
        </div>

        <br />

        <!-- Formulaire principal -->
        <h:form styleClass="form-container">
            <fieldset class="form-fieldset">
                <legend>üìã Informations du mouvement</legend>

                <table class="form">
                    <!-- ID (readonly, visible uniquement en modification) -->
                    <tr rendered="#{modelMouvement.courant.id != null}">
                        <td class="form-label">
                            <h:outputLabel for="id" value="Identifiant :" />
                        </td>
                        <td class="form-input">
                            <h:inputText id="id"
                                         value="#{modelMouvement.courant.id}"
                                         size="10"
                                         readonly="true"
                                         styleClass="readonly-input" />
                            <br />
                            <h:message for="id" errorClass="error" />
                        </td>
                    </tr>

                    <!-- Date du mouvement -->
                    <tr>
                        <td class="form-label">
                            <h:outputLabel for="date" value="üìÖ Date du mouvement :" styleClass="required-field" />
                        </td>
                        <td class="form-input">
                            <h:inputText id="date"
                                         value="#{modelMouvement.courant.date}"
                                         type="date"
                                         required="true"
                                         requiredMessage="La date du mouvement est obligatoire"
                                         styleClass="date-input">
                                <f:convertDateTime pattern="yyyy-MM-dd" type="localDate" />
                            </h:inputText>
                            <br />
                            <span class="field-hint">S√©lectionnez la date √† laquelle le mouvement a eu lieu</span>
                            <br />
                            <h:message for="date" errorClass="error" />
                        </td>
                    </tr>

                    <!-- Libell√© -->
                    <tr>
                        <td class="form-label">
                            <h:outputLabel for="libelle" value="üè∑Ô∏è Libell√© :" styleClass="required-field" />
                        </td>
                        <td class="form-input">
                            <h:inputText id="libelle"
                                         value="#{modelMouvement.courant.libelle}"
                                         size="50"
                                         maxlength="50"
                                         required="true"
                                         requiredMessage="Le libell√© du mouvement est obligatoire"
                                         styleClass="text-input"
                                         placeholder="Ex: Paiement facture √©lectricit√©, Virement salaire..." />
                            <br />
                            <span class="field-hint">Description du mouvement (max 50 caract√®res)</span>
                            <br />
                            <h:message for="libelle" errorClass="error" />
                        </td>
                    </tr>

                    <!-- Montant -->
                    <tr>
                        <td class="form-label">
                            <h:outputLabel for="montant" value="üí∞ Montant (‚Ç¨) :" styleClass="required-field" />
                        </td>
                        <td class="form-input">
                            <h:inputText id="montant"
                                         value="#{modelMouvement.courant.montant}"
                                         size="15"
                                         required="true"
                                         requiredMessage="Le montant du mouvement est obligatoire"
                                         styleClass="number-input">
                                <f:convertNumber type="currency" currencySymbol="" minFractionDigits="2" maxFractionDigits="2" />
                            </h:inputText>
                            <br />
                            <span class="field-hint">Montant en euros (ex: 150.75)</span>
                            <br />
                            <h:message for="montant" errorClass="error" />
                        </td>
                    </tr>

                    <!-- Compte associ√© -->
                    <tr>
                        <td class="form-label">
                            <h:outputLabel for="compte" value="üë§ Compte associ√© :" styleClass="required-field" />
                        </td>
                        <td class="form-input">
                            <h:selectOneMenu id="compte"
                                             value="#{modelMouvement.courant.idCompte}"
                                             required="true"
                                             requiredMessage="Le compte associ√© est obligatoire"
                                             styleClass="select-input">
                                <f:selectItem itemValue="#{null}" itemLabel="-- S√©lectionnez un compte --" />
                                <f:selectItems value="#{modelMouvement.comptesDisponibles}"
                                               var="compte"
                                               itemValue="#{compte.id}"
                                               itemLabel="#{compte.nom} #{compte.prenom}" />
                            </h:selectOneMenu>
                            <br />
                            <span class="field-hint">Choisissez le compte bancaire concern√© par ce mouvement</span>
                            <br />
                            <h:message for="compte" errorClass="error" />
                        </td>
                    </tr>
                </table>
            </fieldset>

            <br />

            <!-- Boutons d'action -->
            <div class="form-actions">
                <h:commandButton action="#{modelMouvement.validerMiseAJour()}"
                                 value="#{modelMouvement.courant.id == null ? '‚úÖ Cr√©er le mouvement' : 'üíæ Enregistrer les modifications'}"
                                 styleClass="btn btn-primary btn-large" />

                <h:button outcome="liste"
                          value="‚ùå Annuler"
                          styleClass="btn btn-secondary btn-large" />
            </div>

            <br />

            <!-- Aide contextuelle -->
            <div class="context-help">
                <h4>‚ÑπÔ∏è Aide</h4>
                <ul>
                    <li><strong>Date :</strong> Indiquez la date r√©elle de la transaction</li>
                    <li><strong>Libell√© :</strong> D√©crivez clairement la nature du mouvement pour faciliter le suivi</li>
                    <li><strong>Montant :</strong> Saisissez un montant positif (les d√©bits et cr√©dits sont g√©r√©s s√©par√©ment)</li>
                    <li><strong>Compte :</strong> S√©lectionnez le compte bancaire sur lequel ce mouvement a √©t√© effectu√©</li>
                </ul>
            </div>
        </h:form>
    </ui:define>

    <!-- M√©tadonn√©es pour la gestion du param√®tre id -->
    <f:metadata>
        <f:viewParam name="id" value="#{modelMouvement.courant.id}" />
        <f:viewAction action="#{modelMouvement.actualiserCourant()}" />
    </f:metadata>
</ui:composition>
</html>
